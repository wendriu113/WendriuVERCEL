<%-include('../cabecalho.ejs')%>

<style>
  /* Estilo base para inputs */
  .grid input {
    width: 100%;
    padding: 10px 12px;
    border: 1px solid #e2e8f0;
    border-radius: 6px;
    font-size: 1rem;
    background: #f8fafc;
    transition: all 0.2s;
    height: 42px;
  }

  /* Estilo específico para CNPJ e telefone */
  #cnpj,
  #telefone {
    font-family: "Consolas", monospace;
    letter-spacing: 1px;
    font-size: 0.95rem;
    background: #f8fafc;
    border: 1px solid #e2e8f0;
    border-radius: 6px;
    padding: 10px 12px;
    height: 42px;
    width: 100%;
  }

  /* Estado de foco */
  #cnpj:focus,
  #telefone:focus {
    outline: none;
    border-color: #2d8cff;
    box-shadow: 0 0 0 3px rgba(45, 140, 255, 0.1);
    background: #fff;
  }

  /* Placeholder */
  #cnpj::placeholder,
  #telefone::placeholder {
    font-family: system-ui, -apple-system, sans-serif;
    letter-spacing: normal;
    color: #a0aec0;
  }

  /* Estilos dos botões */
  .grid footer {
    grid-column: 1 / -1;
    display: flex;
    gap: 12px;
    margin-top: 24px;
  }

  .grid footer button,
  .grid footer a {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 8px 16px;
    border-radius: 6px;
    font-weight: 500;
    text-decoration: none;
    transition: all 0.2s;
    height: 42px;
    min-width: 120px;
    justify-content: center;
  }

  /* Botão principal (Salvar/Adicionar) */
  .grid footer button {
    background: #090b0e; /* Tom mais escuro de azul */
    color: white;
    border: none;
    font-size: 0.95rem;
  }

  .grid footer button:hover {
    background: #1e429f; /* Ainda mais escuro no hover */
  }

  /* Botão secundário (Cancelar) */
  .grid footer a {
    color: #666;
    background: transparent;
    border: 1px solid #e2e8f0;
    font-size: 0.95rem;
  }

  .grid footer a:hover {
    background: #f5f5f5;
    border-color: #cbd5e0;
  }

  /* Ícone SVG para o botão salvar */
  .grid footer button svg {
    width: 20px;
    height: 20px;
  }
</style>

<section class="section">
  <div class="content">
    <header>
      <h3>Adicionar Novo Fornecedor</h3>
    </header>

    <form
      id="form-fornecedor"
      autocomplete="off"
      action="/fornecedoradm/add/ok"
      method="POST"
    >
      <div class="grid">
        <div>
          <label for="nome">Nome/Razão Social</label>
          <input
            id="nome"
            name="nome"
            type="text"
            required
            placeholder="Nome da empresa"
            value="<%= formData?.nome || '' %>"
          />
        </div>

        <div>
          <label for="cnpj">CNPJ</label>
          <input
            id="cnpj"
            name="cnpj"
            required
            data-mask="cnpj"
            placeholder="00.000.000/0000-00"
            maxlength="18"
            value="<%= formData?.cnpj || '' %>"
          />
        </div>

        <div>
          <label for="telefone">Telefone</label>
          <input
            id="telefone"
            name="telefone"
            required
            data-mask="phone"
            placeholder="(00) 00000-0000"
            maxlength="15"
            value="<%= formData?.telefone || '' %>"
          />
        </div>

        <div>
          <label for="email">Email</label>
          <input
            id="email"
            name="email"
            type="email"
            required
            placeholder="email@empresa.com.br"
            value="<%= formData?.email || '' %>"
          />
        </div>

        <div>
          <label for="imagem">Imagem (URL)</label>
          <input
            id="imagem"
            name="imagem"
            type="url"
            placeholder="https://exemplo.com/logo.png"
            value="<%= formData?.imagem || '' %>"
          />
        </div>

        <div class="full">
          <label for="endereco">Endereço Completo</label>
          <input
            id="endereco"
            name="endereco"
            required
            placeholder="Rua, Número, Bairro - Cidade/UF"
            value="<%= formData?.endereco || '' %>"
          />
        </div>

        <footer>
          <button type="submit">Adicionar Fornecedor</button>
          <a href="/fornecedoradm/lst">Cancelar</a>
        </footer>
      </div>
    </form>

    <script>
      // Máscara CNPJ
      const cnpjInput = document.getElementById("cnpj");
      cnpjInput.addEventListener("input", function (e) {
        let value = e.target.value.replace(/\D/g, "");
        if (value.length <= 14) {
          value = value.replace(/(\d{2})(\d)/, "$1.$2");
          value = value.replace(/(\d{3})(\d)/, "$1.$2");
          value = value.replace(/(\d{3})(\d)/, "$1/$2");
          value = value.replace(/(\d{4})(\d)/, "$1-$2");
        }
        e.target.value = value;
      });

      // Máscara Telefone
      const telefoneInput = document.getElementById("telefone");
      telefoneInput.addEventListener("input", function (e) {
        let value = e.target.value.replace(/\D/g, "");
        if (value.length <= 11) {
          value = value.replace(/(\d{2})(\d)/, "($1) $2");
          value = value.replace(/(\d{5})(\d)/, "$1-$2");
        }
        e.target.value = value;
      });

      // Validação antes de enviar
      document
        .getElementById("form-fornecedor")
        .addEventListener("submit", function (e) {
          const cnpj = cnpjInput.value.replace(/\D/g, "");
          const telefone = telefoneInput.value.replace(/\D/g, "");

          if (cnpj.length !== 14) {
            e.preventDefault();
            alert("CNPJ deve conter 14 dígitos");
            cnpjInput.focus();
            return;
          }

          if (telefone.length < 10 || telefone.length > 11) {
            e.preventDefault();
            alert("Telefone deve conter 10 ou 11 dígitos");
            telefoneInput.focus();
            return;
          }
        });
    </script>

    <% if (typeof showAlert !== 'undefined' && showAlert && alertMessage) { %>
    <script>
      alert("<%= alertMessage %>");
    </script>
    <% } %>
  </div>
</section>
<%-include('../rodape.ejs')%>

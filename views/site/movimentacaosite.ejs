<%- include('header.ejs') %>

<section class="stock-container">
  <h2 class="stock-title">Movimentacao de Estoque</h2>

  <% if (!movimentacoes || movimentacoes.length === 0) { %>
  <p>Nenhuma movimentacao encontrada.</p>
  <% } else { %>
  <div class="stock-list">
    <% for (let i = 0; i < movimentacoes.length; i++) { %>
      <% var m = movimentacoes[i]; %>
      <div class="stock-movement-card">
        <div class="stock-movement-content">
          <div class="stock-icon-container <%= m.tipo %>">
            <% if (m.tipo === 'entrada') { %>
              <!-- trending-up SVG -->
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                <path d="M3 17l6-6 4 4 8-8" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M21 15v4h-4" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            <% } else { %>
              <!-- trending-down SVG -->
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                <path d="M21 7l-6 6-4-4-8 8" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M3 9v-4h4" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            <% } %>
          </div>

          <div class="stock-movement-info">
            <div class="stock-movement-header">
              <span class="stock-badge <%= m.tipo %>"><%= m.tipo === 'entrada' ? 'Entrada' : 'Saida' %></span>
              <span class="stock-quantity"><%= m.quantidade %> unidades</span>
            </div>

            <div class="stock-details-grid">
              <div class="stock-detail-item">
                <!-- calendar SVG -->
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                  <rect x="3" y="4" width="18" height="18" rx="2" stroke="currentColor" stroke-width="1.2"/>
                  <path d="M16 2v4M8 2v4M3 10h18" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"/>
                </svg>
                <span><%= new Date(m.data).toLocaleDateString('pt-BR') %></span>
              </div>

              <div class="stock-detail-item">
                <!-- package SVG -->
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                  <path d="M21 16V8a2 2 0 0 0-1-1.732l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.732l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M7 7.5v6.5M17 7.5v6.5" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span><%= m.produto ? (m.produto.nome || m.produto) : 'Produto desconhecido' %></span>
              </div>

              <div class="stock-detail-item">
                <!-- user SVG -->
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                  <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                  <circle cx="12" cy="7" r="4" stroke="currentColor" stroke-width="1.2"/>
                </svg>
                <span><%= m.usuario ? (m.usuario.nome || m.usuario) : '-' %></span>
              </div>

              <div class="stock-detail-item">
                <!-- file-text SVG -->
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                  <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M14 2v6h6" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M8 13h8M8 17h8" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"/>
                </svg>
                <span><%= m.observacao || '' %></span>
              </div>
            </div>
          </div>
        </div>
      <% } %>
    </div>
  <% } %>
</section>

<%- include('footer.ejs') %>